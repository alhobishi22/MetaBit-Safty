# إشعارات تلجرام للبلاغات الجديدة

تم إضافة ميزة جديدة لإرسال إشعارات تلجرام للمستخدمين المسجلين عند إنشاء بلاغ جديد في نظام MetaBit Safety.

## كيفية الإعداد

1. قم بإنشاء ملف `.env` في المجلد الرئيسي للمشروع وأضف توكن بوت تلجرام الخاص بك:

```
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
```

2. تأكد من تثبيت المكتبات المطلوبة:

```
pip install python-telegram-bot python-dotenv
```

## كيفية عمل الميزة

- عند إنشاء بلاغ جديد، سيتم إرسال إشعار تلقائي إلى جميع المستخدمين المسجلين في بوت تلجرام.
- يحتوي الإشعار على معلومات أساسية عن البلاغ مثل نوع البلاغ واسم المبلغ عنه.
- يتضمن الإشعار زر للانتقال مباشرة إلى تطبيق MetaBit Safety المصغر.

## ملاحظات هامة

- يتم إرسال الإشعارات بشكل غير متزامن لتجنب تأخير استجابة التطبيق.
- يتم تسجيل نجاح أو فشل إرسال الإشعارات في سجلات التطبيق.
- يمكن للمستخدمين الوصول إلى التطبيق المصغر مباشرة من خلال الإشعار.
- تم تعديل تنسيق الإشعارات لتجنب مشكلة `Button_type_invalid` عن طريق:
  - إزالة علامات التنسيق النصي (*) من الرسائل
  - تحديد معلمة `text` بشكل صريح للأزرار
  - تعطيل وضع التنسيق باستخدام `parse_mode=None`

## تخصيص الإشعارات

يمكنك تخصيص محتوى الإشعارات من خلال تعديل الدالة `send_new_report_notification` في ملف `telegram_bot.py`.

## اختبار الإشعارات

يمكنك اختبار وظيفة الإشعارات باستخدام ملف `test_notification.py`:

```
python test_notification.py
```

سيقوم هذا الملف بإرسال إشعار تجريبي إلى جميع المستخدمين المسجلين في بوت تلجرام.
